require("source-map-support").install(),module.exports=function(e){var t={},r={11:0};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.e=function(t){if(0!==r[t]){var n=require("./chunks/"+({0:"admin~contact~drawings~home~not-found~paintings~presentation~privacy~sculptures",1:"admin",2:"contact",3:"drawings",4:"home",5:"image",6:"not-found",7:"paintings",8:"presentation",9:"privacy",10:"sculptures"}[t]||t)+".js"),a=n.modules,s=n.ids;for(var i in a)e[i]=a[i];for(var o=0;o<s.length;o++)r[s[o]]=0}return Promise.all([])},n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/assets/",n.oe=function(e){process.nextTick((function(){throw e}))},n(n.s=58)}([function(e,t){e.exports=require("sequelize")},function(e,t){e.exports=require("react")},function(e,t,r){e.exports={port:process.env.PORT||3e3,trustProxy:process.env.TRUST_PROXY||"loopback",api:{clientUrl:process.env.API_CLIENT_URL||"",serverUrl:process.env.API_SERVER_URL||`http://localhost:${process.env.PORT||3e3}`},databaseUrl:process.env.DATABASE_URL||"mysql:database.mysql",databaseName:process.env.DATABASE_NAME||"develop",databaseUsername:process.env.DATABASE_USERNAME||"root",databasePassword:process.env.DATABASE_PASSWORD||"root",databaseHost:process.env.DATABASE_HOST||"localhost",libraryPath:`${process.env.PHOTOS_PATH}`,paintingsPath:`${process.env.PHOTOS_PATH}/paintings`,paintingsMDPath:`${process.env.PHOTOS_PATH}/paintings/md`,paintingsSMPath:`${process.env.PHOTOS_PATH}/paintings/sm`,sculpturesPath:`${process.env.PHOTOS_PATH}/sculptures`,sculpturesMDPath:`${process.env.PHOTOS_PATH}/sculptures/md`,sculpturesSMPath:`${process.env.PHOTOS_PATH}/sculptures/sm`,drawingsPath:`${process.env.PHOTOS_PATH}/drawings`,drawingsMDPath:`${process.env.PHOTOS_PATH}/drawings/md`,drawingsSMPath:`${process.env.PHOTOS_PATH}/drawings/sm`,miscellaneousPath:`${process.env.PHOTOS_PATH}/miscellaneous`,analytics:{googleTrackingId:process.env.GOOGLE_TRACKING_ID},auth:{jwt:{name:process.env.JWT_NAME||"auth-token",secret:process.env.JWT_SECRET||"15htDn-7uU-620Ghhwz"}}}},function(e,t,r){"use strict";t.a={PAINTING:{TYPE:"painting",PATH:"/images/paintings",TITLE:"Peintures",ALT_IMAGE:"Peinture de Marion Casters"},DRAWING:{TYPE:"drawing",PATH:"/images/drawings",TITLE:"Dessins",ALT_IMAGE:"Dessin de Marion Casters"},SCULPTURE:{TYPE:"sculpture",PATH:"/images/sculptures",TITLE:"Sculptures",ALT_IMAGE:"Sculpture de Marion Casters"},LG_SIZE:"lg",MD_SIZE:"md",SM_SIZE:"sm",SM_PX:384,MD_PX:640,FORMAT_DATE:"dd/MM/yyyy"}},function(e,t){e.exports=require("prop-types")},function(e,t){e.exports=require("lodash")},function(e,t,r){"use strict";t.a={HOME:"/home",PEINTURES:"/peintures",SCULPTURES:"/sculptures",DESSINS:"/dessins",CONTACT:"/contact",PRESENTATION:"/presentation",CONFIDENTIALITE:"/politique-de-confidentialite",REGISTER:"/register",ADMIN:"/admin"}},function(e,t){e.exports=require("@babel/runtime/helpers/defineProperty")},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("react-dom/server")},function(e,t,r){"use strict";t.a={TYPE:"content",KEY:{HOME1:"Home 1",HOME2:"Home 2",HOME3:"Home 3",PRESENTATION:"Présentation",CONTACT_ADDRESS:"Adresse",CONTACT_PHONE:"Téléphone",CONTACT_EMAIL:"Email"},CONTENT_IMAGE_PATH:"/images/miscellaneous",PRESENTATION_IMAGE_TITLE:"portrait",PRESENTATION_IMAGE_FILE:"portrait.jpg",PRESENTATION_IMAGE_ALT:"Portrait de Marion Casters",HOME_IMAGE_PORTRAIT:"home-portrait",HOME_IMAGE_LANDSCAPE:"home-landscape",HOME_IMAGE_PORTRAIT_FILE:"home-portrait.jpg",HOME_IMAGE_LANDSCAPE_FILE:"home-landscape.jpg",HOME_IMAGE_ALT:"Oeuvre de Marion Casters"}},function(e,t,r){var n=r(57),a=r(40),s="string"==typeof n?[[e.i,n,""]]:n;(t=e.exports=n.locals||{})._getContent=function(){return s},t._getCss=function(){return""+n},t._insertCss=function(e){return a(s,e)}},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("express")},function(e,t){e.exports=require("apollo-cache-inmemory")},function(e,t){e.exports=require("jimp")},function(e,t){e.exports=require("body-parser")},function(e,t){e.exports=require("apollo-server-express")},function(e,t){e.exports=require("bcrypt")},function(e,t){e.exports=require("./chunk-manifest.json")},function(e,t){e.exports=require("@apollo/react-hooks")},function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return a}));const n="Marion Casters Artiste Peintre Peinture Sculpture Dessin Bordeaux France",a={PAINTING:"Images et descriptions des peintures de Marion Casters",SCULPTURE:"Images et descriptions des sculptures de Marion Casters",DRAWING:"Images et descriptions des dessins de Marion Casters",HOME:"Bienvenue sur le site de présentation des oeuvres de Marion Casters",PRESENTATION:"Démarche artistique de Marion Casters",CONTACT:"Contacter Marion Casters pour obtenir des renseignements sur ses oeuvres",PRIVACY:"Détail de la politique de confidentialité du site",ADMIN:"Administration du site"}},function(e,t){e.exports=require("core-js/modules/es.symbol.description")},function(e,t){e.exports=require("@babel/runtime/helpers/extends")},function(e,t,r){"use strict";var n=r(1);const a=Object(n.createContext)({pathname:"",query:{}});t.a=a},function(e,t){e.exports=require("isomorphic-style-loader/withStyles")},function(e,t){e.exports=require("pretty-error")},function(e,t){e.exports=require("@apollo/react-ssr")},function(e,t){e.exports=require("cors")},function(e,t){e.exports=require("express-session")},function(e,t){e.exports=require("@loadable/server")},function(e,t){e.exports=require("isomorphic-style-loader/StyleContext")},function(e,t){e.exports=require("serialize-javascript")},function(e,t){e.exports=require("universal-router")},function(e,t){e.exports=require("apollo-client")},function(e,t){e.exports=require("apollo-link")},function(e,t){e.exports=require("apollo-link-error")},function(e,t){e.exports=require("apollo-link-schema")},function(e,t){e.exports=require("graphql-tag")},function(e,t,r){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r=function(e,t){var r=e[1]||"",n=e[3];if(!n)return r;if(t&&"function"==typeof btoa){var a=(i=n,o=btoa(unescape(encodeURIComponent(JSON.stringify(i)))),l="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(o),"/*# ".concat(l," */")),s=n.sources.map((function(e){return"/*# sourceURL=".concat(n.sourceRoot).concat(e," */")}));return[r].concat(s).concat([a]).join("\n")}var i,o,l;return[r].join("\n")}(t,e);return t[2]?"@media ".concat(t[2],"{").concat(r,"}"):r})).join("")},t.i=function(e,r){"string"==typeof e&&(e=[[null,e,""]]);for(var n={},a=0;a<this.length;a++){var s=this[a][0];null!=s&&(n[s]=!0)}for(var i=0;i<e.length;i++){var o=e[i];null!=o[0]&&n[o[0]]||(r&&!o[2]?o[2]=r:r&&(o[2]="(".concat(o[2],") and (").concat(r,")")),t.push(o))}},t}},function(e,t,r){"use strict";
/*! Isomorphic Style Loader | MIT License | https://github.com/kriasoft/isomorphic-style-loader */var n={};function a(e){e.forEach((function(e){if(--n[e]<=0){var t=document.getElementById(e);t&&t.parentNode.removeChild(t)}}))}e.exports=function(e,t){for(var r,s=void 0===t?{}:t,i=s.replace,o=void 0!==i&&i,l=s.prepend,u=void 0!==l&&l,c=s.prefix,d=void 0===c?"s":c,p=[],m=0;m<e.length;m++){var h=e[m],f=h[0],g=h[1],y=h[2],E=h[3],_=""+d+f+"-"+m;if(p.push(_),!n[_]||o){n[_]=1;var w=document.getElementById(_),T=!1;w||(T=!0,(w=document.createElement("style")).setAttribute("type","text/css"),w.id=_,y&&w.setAttribute("media",y));var N=g;E&&"function"==typeof btoa&&(N+="\n/*# sourceMappingURL=data:application/json;base64,"+(r=JSON.stringify(E),btoa(encodeURIComponent(r).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode("0x"+t)}))))+"*/",N+="\n/*# sourceURL="+E.file+"?"+_+"*/"),"textContent"in w?w.textContent=N:w.styleSheet.cssText=N,T&&(u?document.head.insertBefore(w,document.head.childNodes[0]):document.head.appendChild(w))}else n[_]++}return a.bind(null,p)}},function(e,t){e.exports=require("core-js/modules/esnext.set.add-all")},function(e,t){e.exports=require("core-js/modules/esnext.set.delete-all")},function(e,t){e.exports=require("core-js/modules/esnext.set.difference")},function(e,t){e.exports=require("core-js/modules/esnext.set.every")},function(e,t){e.exports=require("core-js/modules/esnext.set.filter")},function(e,t){e.exports=require("core-js/modules/esnext.set.find")},function(e,t){e.exports=require("core-js/modules/esnext.set.intersection")},function(e,t){e.exports=require("core-js/modules/esnext.set.is-disjoint-from")},function(e,t){e.exports=require("core-js/modules/esnext.set.is-subset-of")},function(e,t){e.exports=require("core-js/modules/esnext.set.is-superset-of")},function(e,t){e.exports=require("core-js/modules/esnext.set.join")},function(e,t){e.exports=require("core-js/modules/esnext.set.map")},function(e,t){e.exports=require("core-js/modules/esnext.set.reduce")},function(e,t){e.exports=require("core-js/modules/esnext.set.some")},function(e,t){e.exports=require("core-js/modules/esnext.set.symmetric-difference")},function(e,t){e.exports=require("core-js/modules/esnext.set.union")},function(e,t,r){(e.exports=r(39)(!1)).push([e.i,"html{display:flex;align-items:center;justify-content:center;padding:0 2rem;height:100%;font-family:sans-serif;text-align:center;color:#888}body{margin:0}h1{font-weight:400;color:#555}pre{white-space:pre-wrap;text-align:left}",""])},function(e,t,r){"use strict";r.r(t);r(41),r(42),r(43),r(44),r(45),r(46),r(47),r(48),r(49),r(50),r(51),r(52),r(53),r(54),r(55),r(56);var n=r(23),a=r.n(n),s=r(12),i=r.n(s),o=r(13),l=r.n(o),u=r(16),c=r.n(u),d=r(1),p=r.n(d),m=r(9),h=r.n(m),f=r(26),g=r.n(f),y=r(27),E=r(17),_=r(28),w=r.n(_),T=r(29),N=r.n(T),I=r(30),S=r(20),v=r(31),P=r.n(v),x=r(4),A=r.n(x),b=r(24),D="/Users/marioncasters/Sites/GIT/marioncasters-site/src/components/App.js";const q=({client:e,insertCss:t,context:r,children:n})=>p.a.createElement(S.ApolloProvider,{client:e,__source:{fileName:D,lineNumber:9},__self:void 0},p.a.createElement(b.a.Provider,{value:r,__source:{fileName:D,lineNumber:10},__self:void 0},p.a.createElement(P.a.Provider,{value:{insertCss:t},__source:{fileName:D,lineNumber:11},__self:void 0},n)));q.propTypes={client:A.a.object.isRequired,insertCss:A.a.func.isRequired,context:A.a.object.isRequired,children:A.a.node.isRequired};var O=q,R=(r(22),r(32)),M=r.n(R),C=r(2),U=r.n(C),j="/Users/marioncasters/Sites/GIT/marioncasters-site/src/components/Html.js";var k=({title:e,description:t,keywords:r,styles:n=[],scripts:a=[],asyncScripts:s=[],asyncLinks:i=[],app:o,children:l})=>p.a.createElement("html",{className:"no-js",lang:"fr",__source:{fileName:j,lineNumber:39},__self:void 0},p.a.createElement("head",{__source:{fileName:j,lineNumber:40},__self:void 0},p.a.createElement("meta",{charSet:"utf-8",__source:{fileName:j,lineNumber:41},__self:void 0}),p.a.createElement("meta",{httpEquiv:"x-ua-compatible",content:"ie=edge",__source:{fileName:j,lineNumber:42},__self:void 0}),p.a.createElement("title",{__source:{fileName:j,lineNumber:43},__self:void 0},e),p.a.createElement("meta",{name:"description",content:t,__source:{fileName:j,lineNumber:44},__self:void 0}),p.a.createElement("meta",{name:"keywords",content:r,__source:{fileName:j,lineNumber:45},__self:void 0}),p.a.createElement("meta",{name:"viewport",content:"width=device-width, initial-scale=1",__source:{fileName:j,lineNumber:46},__self:void 0}),p.a.createElement("meta",{name:"theme-color",content:"#555555",__source:{fileName:j,lineNumber:47},__self:void 0}),a.map(e=>p.a.createElement("link",{key:e,rel:"preload",href:e,as:"script",__source:{fileName:j,lineNumber:49},__self:void 0})),i.map(e=>e),p.a.createElement("link",{rel:"manifest",href:"/site.webmanifest",__source:{fileName:j,lineNumber:52},__self:void 0}),p.a.createElement("link",{rel:"apple-touch-icon",sizes:"192x192",href:"/icon-192.png",__source:{fileName:j,lineNumber:53},__self:void 0}),p.a.createElement("link",{rel:"icon",sizes:"192x192",href:"/icon-192.png",__source:{fileName:j,lineNumber:54},__self:void 0}),p.a.createElement("link",{rel:"icon",sizes:"512x512",href:"/icon-512.png",__source:{fileName:j,lineNumber:55},__self:void 0}),p.a.createElement("link",{href:"https://fonts.googleapis.com/css?family=Montserrat&display=swap",rel:"stylesheet",__source:{fileName:j,lineNumber:56},__self:void 0}),n.map(e=>p.a.createElement("style",{key:e.id,id:e.id,dangerouslySetInnerHTML:{__html:e.cssText},__source:{fileName:j,lineNumber:61},__self:void 0}))),p.a.createElement("body",{__source:{fileName:j,lineNumber:68},__self:void 0},p.a.createElement("div",{id:"app",dangerouslySetInnerHTML:{__html:l},__source:{fileName:j,lineNumber:69},__self:void 0}),p.a.createElement("script",{dangerouslySetInnerHTML:{__html:`window.App=${M()(o)}`},__source:{fileName:j,lineNumber:70},__self:void 0}),a.map(e=>p.a.createElement("script",{key:e,src:e,__source:{fileName:j,lineNumber:74},__self:void 0})),s.map(e=>e),U.a.analytics.googleTrackingId&&p.a.createElement("script",{dangerouslySetInnerHTML:{__html:"window.ga=function(){ga.q.push(arguments)};ga.q=[];ga.l=+new Date;"+`ga('create','${U.a.analytics.googleTrackingId}','auto');ga('send','pageview')`},__source:{fileName:j,lineNumber:78},__self:void 0}),U.a.analytics.googleTrackingId&&p.a.createElement("script",{src:"https://www.google-analytics.com/analytics.js",async:!0,defer:!0,__source:{fileName:j,lineNumber:87},__self:void 0}))),V=r(25),$=r.n(V),L=r(11),G=r.n(L),H="/Users/marioncasters/Sites/GIT/marioncasters-site/src/routes/error/ErrorPage.js";function B({error:e}){return p.a.createElement("div",{__source:{fileName:H,lineNumber:18},__self:this},p.a.createElement("h1",{__source:{fileName:H,lineNumber:19},__self:this},"Error"),p.a.createElement("p",{__source:{fileName:H,lineNumber:20},__self:this},"Sorry, a critical error occurred on this page."))}B.propTypes={error:A.a.shape({name:A.a.string.isRequired,message:A.a.string.isRequired,stack:A.a.string.isRequired})},B.defaultProps={error:null};$()(G.a)(B);var Y=r(33),F=r.n(Y),z=r(21),W=r(6);var K={path:"",children:[{path:"",load:()=>Promise.all([r.e(0),r.e(4)]).then(r.bind(null,178))},{path:W.a.HOME,load:()=>Promise.all([r.e(0),r.e(4)]).then(r.bind(null,178))},{path:W.a.PEINTURES,load:()=>Promise.all([r.e(0),r.e(7)]).then(r.bind(null,175))},{path:W.a.SCULPTURES,load:()=>Promise.all([r.e(0),r.e(10)]).then(r.bind(null,179))},{path:W.a.DESSINS,load:()=>Promise.all([r.e(0),r.e(3)]).then(r.bind(null,182))},{path:W.a.PRESENTATION,load:()=>Promise.all([r.e(0),r.e(8)]).then(r.bind(null,177))},{path:W.a.CONTACT,load:()=>Promise.all([r.e(0),r.e(2)]).then(r.bind(null,176))},{path:W.a.CONFIDENTIALITE,load:()=>Promise.all([r.e(0),r.e(9)]).then(r.bind(null,181))},{path:W.a.ADMIN,load:()=>Promise.all([r.e(0),r.e(1)]).then(r.bind(null,174))},{path:"(.*)",load:()=>Promise.all([r.e(0),r.e(6)]).then(r.bind(null,180))}],async action({next:e}){const t=await e();return t.title=`${t.title||"Page sans titre"} - Marion Casters`,t.description=t.description||"-",t.keywords=z.b,t}},Q=new F.a(K,{resolveRoute:(e,t)=>"function"==typeof e.route.load?e.route.load().then(r=>r.default(e,t)):"function"==typeof e.route.action?e.route.action(e,t):void 0}),X=r(34),J=r(35),Z=r(36),ee=r(37),te=r(38),re=r.n(te),ne=r(14);function ae(e){switch(e.__typename){case"NewsItem":return e.link?`NewsItem:${e.link}`:Object(ne.defaultDataIdFromObject)(e);default:return Object(ne.defaultDataIdFromObject)(e)}}var se=r(5);const ie=["\n  adminStatus: AdminStatus!\n"],oe=[...["\n  type AdminStatus {\n    isConnected: Boolean!\n  }\n"]],le=r.n(se)()({}),ue=[...ie],ce=[];function de(e){const t=new ne.InMemoryCache({dataIdFromObject:ae});t.writeData({data:{adminStatus:{__typename:"AdminStatus",isConnected:!1}}});const r=Object(J.from)([Object(Z.onError)(({graphQLErrors:e,networkError:t})=>{e&&e.map(({message:e,locations:t,path:r})=>console.warn(`[GraphQL error]: Message: ${e}, Location: ${t}, Path: ${r}`)),t&&console.warn(`[Network error]: ${t}`)}),new ee.SchemaLink({...e})]);return new X.ApolloClient({link:r,cache:t,typeDefs:re()(oe),resolvers:le,ssrMode:!0,queryDeduplication:!0})}var pe=r(0),me=r.n(pe);var he=new me.a(U.a.databaseName,U.a.databaseUsername,U.a.databasePassword,{host:U.a.databaseHost,dialect:"mysql",operatorsAliases:pe.Op,define:{freezeTableName:!0,timestamps:!1}});var fe=he.define("User",{id:{type:me.a.UUID,defaultValue:me.a.UUIDV1,primaryKey:!0},username:{type:me.a.STRING(50),unique:!0},email:{type:me.a.STRING(50),validate:{isEmail:!0},unique:!0},emailConfirmed:{type:me.a.BOOLEAN,defaultValue:!1},password:me.a.STRING(255)},{indexes:[{fields:["username"]}]});var ge=he.define("Painting",{id:{type:me.a.UUID,defaultValue:me.a.UUIDV1,primaryKey:!0,get(){return this.getDataValue("id")}},title:{type:me.a.STRING(50),allowNull:!1,get(){return this.getDataValue("title")},set(e){this.setDataValue("title",e)}},date:{type:me.a.DATEONLY,allowNull:!1,get(){return this.getDataValue("date")},set(e){this.setDataValue("date",e)}},technique:{type:me.a.STRING(255),allowNull:!1,get(){return this.getDataValue("technique")},set(e){this.setDataValue("technique",e)}},description:{type:me.a.STRING(255),allowNull:!0,get(){return this.getDataValue("description")},set(e){this.setDataValue("description",e)}},height:{type:me.a.INTEGER,allowNull:!1,get(){return this.getDataValue("height")},set(e){this.setDataValue("height",e)}},width:{type:me.a.INTEGER,allowNull:!1,get(){return this.getDataValue("width")},set(e){this.setDataValue("width",e)}}},{timestamps:!0});var ye=he.define("Sculpture",{id:{type:me.a.UUID,defaultValue:me.a.UUIDV1,primaryKey:!0,get(){return this.getDataValue("id")}},title:{type:me.a.STRING(50),allowNull:!1,get(){return this.getDataValue("title")},set(e){this.setDataValue("title",e)}},date:{type:me.a.DATEONLY(10),allowNull:!1,get(){return this.getDataValue("date")},set(e){this.setDataValue("date",e)}},technique:{type:me.a.STRING(255),allowNull:!1,get(){return this.getDataValue("technique")},set(e){this.setDataValue("technique",e)}},description:{type:me.a.STRING(255),allowNull:!0,get(){return this.getDataValue("description")},set(e){this.setDataValue("description",e)}},height:{type:me.a.INTEGER,allowNull:!1,get(){return this.getDataValue("height")},set(e){this.setDataValue("height",e)}},width:{type:me.a.INTEGER,allowNull:!1,get(){return this.getDataValue("width")},set(e){this.setDataValue("width",e)}},length:{type:me.a.INTEGER,allowNull:!1,get(){return this.getDataValue("length")},set(e){this.setDataValue("length",e)}}},{timestamps:!0});var Ee=he.define("Drawing",{id:{type:me.a.UUID,defaultValue:me.a.UUIDV1,primaryKey:!0,get(){return this.getDataValue("id")}},title:{type:me.a.STRING(50),allowNull:!1,get(){return this.getDataValue("title")},set(e){this.setDataValue("title",e)}},date:{type:me.a.DATEONLY(10),allowNull:!1,get(){return this.getDataValue("date")},set(e){this.setDataValue("date",e)}},technique:{type:me.a.STRING(255),allowNull:!1,get(){return this.getDataValue("technique")},set(e){this.setDataValue("technique",e)}},description:{type:me.a.STRING(255),allowNull:!0,get(){return this.getDataValue("description")},set(e){this.setDataValue("description",e)}},height:{type:me.a.INTEGER,allowNull:!1,get(){return this.getDataValue("height")},set(e){this.setDataValue("height",e)}},width:{type:me.a.INTEGER,allowNull:!1,get(){return this.getDataValue("width")},set(e){this.setDataValue("width",e)}}},{timestamps:!0});var _e=he.define("Content",{id:{type:me.a.UUID,defaultValue:me.a.UUIDV1,primaryKey:!0,get(){return this.getDataValue("id")}},key:{type:me.a.STRING(50),allowNull:!1,get(){return this.getDataValue("key")},set(e){this.setDataValue("key",e)}},text:{type:me.a.TEXT,allowNull:!1,get(){return this.getDataValue("text")},set(e){this.setDataValue("text",e)}}});var we={sync:function(...e){return he.sync(...e)}},Te=r(7),Ne=r.n(Te),Ie=r(3);var Se=class{constructor(e){Ne()(this,"getByName",async e=>this.model.findOne({where:{title:e}})),Ne()(this,"getById",async e=>this.model.findOne({where:{id:e}})),Ne()(this,"getAllItems",async()=>this.model.findAll({order:pe.Sequelize.col("date")})),Ne()(this,"getItemsByPart",async(e,t)=>{let r,n;return 0===t?(r=new Date(e,0,1),n=new Date(e,11,31)):1===t?(r=new Date(e,0,1),n=new Date(e,5,31)):(r=new Date(e,6,1),n=new Date(e,11,31)),this.model.findAll({where:{date:{[pe.Op.gte]:r,[pe.Op.lte]:n}},order:pe.Sequelize.col("date")})}),Ne()(this,"add",async e=>this.model.create(e)),Ne()(this,"update",async(e,t)=>{return await this.model.update({id:e,...t},{where:{id:e}}),await this.model.findOne({where:{id:e}})}),Ne()(this,"delete",async e=>this.model.destroy({where:{id:e}})),this.model={},this.init(e)}init(e){if(e===Ie.a.PAINTING.TYPE)this.model=ge;else if(e===Ie.a.DRAWING.TYPE)this.model=Ee;else{if(e!==Ie.a.SCULPTURE.TYPE)throw new Error(`Type ${e} inexistant`);this.model=ye,this.isSculpture=!0}}get(e){if(!this.has(e))throw new Error(`Property ${e} not found`);return this.model[e]}has(e){return e in this.model}};const ve=["\n  type Item {\n    id: ID!\n    title: String!\n    date: String!\n    technique: String!\n    description: String\n    length: Int\n    height: Int!\n    width: Int!\n  }\n"],Pe=["\n  getAllItems(\n     type: String!\n  ): [Item]\n  \n  getItemsByPart(\n    year: Int!\n    type: String!\n    half: Int!\n  ): [Item]\n"],xe={RootQuery:{getAllItems:async(e,{type:t})=>new Se(t).getAllItems(),getItemsByPart:async(e,{type:t,year:r,half:n})=>new Se(t).getItemsByPart(r,n)}};var Ae=r(8),be=r.n(Ae),De=r(15),qe=r.n(De),Oe=r(10);const Re=(e,t)=>{const r=`${e}.jpg`;return t===Ie.a.SCULPTURE.TYPE?[`${U.a.sculpturesPath}/${r}`,`${U.a.sculpturesMDPath}/${r}`,`${U.a.sculpturesSMPath}/${r}`]:t===Ie.a.DRAWING.TYPE?[`${U.a.drawingsPath}/${r}`,`${U.a.drawingsMDPath}/${r}`,`${U.a.drawingsSMPath}/${r}`]:t===Ie.a.PAINTING.TYPE?[`${U.a.paintingsPath}/${r}`,`${U.a.paintingsMDPath}/${r}`,`${U.a.paintingsSMPath}/${r}`]:null},Me=async(e,t)=>{const{stream:r}=await e;return new Promise((e,n)=>r.pipe(be.a.createWriteStream(t)).on("error",e=>{r.truncated&&be.a.unlinkSync(t),n(e)}).on("finish",()=>{e(!0)}))},Ce=(e,t,r)=>new Promise((n,a)=>qe.a.read(e,(e,s)=>{e&&a(e);const i=s.getHeight()<s.getWidth(),o=i?r:qe.a.AUTO,l=i?qe.a.AUTO:r;s.resize(o,l).quality(75).write(t),n(!0)})),Ue=async(e,t,r)=>{const n=Re(r,t);return Promise.all([await Me(e,n[0]),Ce(n[0],n[1],Ie.a.MD_PX),Ce(n[0],n[2],Ie.a.SM_PX)])},je=async(e,t,r)=>{const n=Re(e,r),a=Re(t,r);return Promise.all(n.map((e,t)=>(be.a.existsSync(e)&&be.a.rename(e,a[t],e=>!e),!1)))},ke=async e=>{be.a.unlink(`${e}`,e=>!e)},Ve=async(e,t,r)=>{if(r===Ie.a.SCULPTURE.TYPE)return(async(e,t)=>{return Promise.all(e.map((e,r)=>{const n=`${t}_${r+1}`;return Ue(e,Ie.a.SCULPTURE.TYPE,n)}))})(e,t);const n=await e[0];if(r===Oe.a.TYPE){const e=`${U.a.miscellaneousPath}/${t}.jpg`;return Me(n,e)}return Ue(n,r,t)},$e=async(e,t)=>{let r;if(t===Ie.a.SCULPTURE.TYPE){let n;for(r=[],n=1;n<5;n++)Array.prototype.push.apply(r,Re(`${e}_${n}`,t))}else r=Re(e,t);return await r.every(ke)};var Le=async e=>{if(!e.session.userId)return!1;return!!await fe.findOne({where:{id:e.session.userId}})};const Ge={Mutation:{async addItem(e,{input:{pictures:t,type:r,...n}},{req:a}){if(!await Le(a))throw new Error("Erreur d'authentification");const{title:s}=n,i=new Se(r);if(await i.getByName(s))throw new Error("Nom de l'item déjà existant en Bdd");if(!await Ve(t,s,r))throw new Error("Erreur à l'écriture des fichiers");const o=await i.add(n,r);if(!o)throw $e(s,r),new Error("Erreur à l'enregistrement en base de donnée");return o},async updateItem(e,{id:t,input:{pictures:r,type:n,...a}},{req:s}){if(!await Le(s))throw new Error("Erreur d'authentification");const i=new Se(n),o=await i.getById(t);if(!o)throw new Error("Item à modifier introuvable en BDD");const{title:l}=a,u=await i.getByName(l,n);if(u&&u.id!==t)throw new Error("Nom d'item déjà existant en Bdd");const c=o.title;if(r.length>0){if(!await $e(c,n))throw new Error("Echec de la suppression des anciennes images");if(!await Ve(r,l,n))throw new Error("Erreur à l'écriture des nouveaux fichiers")}else if(c!==l){if(!await(async(e,t,r)=>{if(r===Ie.a.SCULPTURE.TYPE){let n=1;const a=[];for(;n<5;){const s=`${e}_${n}`,i=`${t}_${n}`;a.push(je(s,i,r)),n++}return Promise.all(a)}return je(e,t,r)})(c,l,n))throw new Error("Erreur au renommage des fichiers")}const d=await i.update(t,a);if(!d)throw new Error("Erreur à l'enregistrement en base de donnée");return d},async deleteItem(e,{id:t,type:r},{req:n}){if(!await Le(n))throw new Error("Erreur d'authentification");const a=new Se(r),s=await a.getById(t);if(!s)throw new Error("Item absent en BDD");if(!await $e(s.title,r))throw new Error("Echec de la suppression des images");return a.delete(t).then(e=>e).catch(()=>{throw new Error("Echec de la suppression en Bdd")}),t}}},He=[...ve,...["\n  input ItemInput {\n    pictures: [Upload]!\n    type: String!\n    title: String!\n    date: String!\n    technique: String!\n    description: String\n    length: Int\n    height: Int!\n    width: Int!\n  }\n  "]],Be=[...Pe],Ye=[...["\n  addItem (\n    input: ItemInput!\n  ): Item!\n  \n  updateItem (\n    id: ID!\n    input: ItemInput!\n  ): Item!\n  \n  deleteItem(\n     id: ID!\n     type: String!\n  ): ID!\n"]],Fe=Object(se.merge)(xe,Ge),ze=["\n  type DatabaseUser {\n    id: String\n    username: String\n    email: String\n    password: String\n  }\n"],We=["\n  getAllUsers: [DatabaseUser]\n\n  getUser(\n    username: String!\n  ): DatabaseUser\n  \n  checkIsAdmin: Boolean!\n"],Ke={RootQuery:{getAllUsers:async()=>fe.findAll(),getUser:async(e,{username:t})=>fe.findOne({where:{username:t}}),checkIsAdmin:async(e,t,{req:r})=>r.session.isAdmin}};var Qe=r(18),Xe=r.n(Qe);const Je={Mutation:{signup:async(e,{input:t},{req:r})=>{if(await fe.findOne({where:{username:t.username}}))throw new Error("Utilisateur déjà existant");const n=await Xe.a.hash(t.password,10);if(!n)throw new Error("Erreur de hashing du mot de passe");const a=await fe.create({username:t.username,email:t.email,password:n});if(!a)throw new Error("Erreur à la création du user en BDD");return r.session.userId=a.id,!0},login:async(e,{input:{username:t,password:r}},{req:n})=>{const a=await fe.findOne({where:{username:t}});return!!a&&(!!await Xe.a.compare(r,a.password)&&(n.session.userId=a.id,!0))},logout:async(e,t,{req:r,res:n})=>(r.session.destroy(()=>!1),n.clearCookie(U.a.auth.jwt.name),!0)}},Ze=[...ze,...["\n  input SignupInput {\n    username: String!\n    email: String!\n    password: String!\n  }\n  \n  input LoginInput {\n    username: String!\n    password: String!\n  }\n"]],et=[...We],tt=[...["\n  signup(\n    input: SignupInput!\n  ): Boolean\n  \n  login(\n    input: LoginInput!\n  ): Boolean\n  \n  logout: Boolean\n"]],rt=Object(se.merge)(Ke,Je),nt={RootQuery:{getAllContent:async()=>await _e.findAll(),getContent:async(e,{key:t})=>await _e.findOne({where:{key:t}})}},at={Mutation:{addContent:async(e,{input:t},{req:r})=>{await Le(r);const{key:n}=t;let a=await _e.findOne({where:{key:n}});return a?(await a.update({text:t.text}),a=await _e.findOne({where:{key:n}})):a=await _e.create(t),a},async addPicture(e,{picture:t,title:r},{req:n}){if(!await Le(n))throw new Error("Erreur d'authentification");const a=[t];if(!await Ve(a,r,Oe.a.TYPE))throw new Error("Erreur à l'écriture des fichiers");return!0}}},st=[...["\n  type Content {\n    id: ID!\n    key: String!\n    text: String!\n  }\n"],...["\n  input ContentInput {\n    key: String!\n    text: String!\n  }\n  "]],it=[...["\n  getAllContent: [Content]\n  \n  getContent(key: String!): Content\n"]],ot=[...["\n  addContent(input: ContentInput!): Content!\n  \n  addPicture(picture: Upload!, title: String!): Boolean!\n"]],lt=Object(se.merge)(nt,at);var ut={typeDefs:[...[" \n  schema { \n    query: RootQuery \n    mutation: Mutation \n  } \n"],...[` \n  type RootQuery { \n    ${[...Be,...et,...it,...ue]} \n  } \n`],...[` \n  type Mutation { \n    ${[...Ye,...tt,...ot,...ce]} \n  } \n`],...[...st,...He,...Ze,...oe]],resolvers:Object(se.merge)(Fe,rt,lt)},ct=r(19),dt=r.n(ct),pt="/Users/marioncasters/Sites/GIT/marioncasters-site/src/server.js";process.on("unhandledRejection",(e,t)=>{console.error("Unhandled Rejection at:",t,"reason:",e),process.exit(1)}),global.navigator=global.navigator||{},global.navigator.userAgent=global.navigator.userAgent||"all";const mt=l()();mt.set("trust proxy",U.a.trustProxy),mt.use(l.a.static(i.a.resolve(__dirname,"public"))),mt.use("/images",l.a.static(i.a.resolve(U.a.libraryPath))),mt.use(c.a.urlencoded({extended:!0})),mt.use(c.a.json()),mt.use(w()()),mt.use(N()({name:U.a.auth.jwt.name,secret:U.a.auth.jwt.secret,resave:!0,saveUninitialized:!0,cookie:{httpOnly:!0,secure:!0,maxAge:864e5}})),new E.ApolloServer({cors:!0,...ut,context:({req:e,res:t})=>({req:e,res:t}),uploads:!0,introspection:!1,playground:!1,debug:!1,pretty:!1}).applyMiddleware({app:mt}),mt.get("*",async(e,t,r)=>{try{const r=new Set,n=(...e)=>{e.forEach(e=>r.add(e._getCss()))},s=de({schema:Object(E.makeExecutableSchema)(ut),context:{req:e}}),o={pathname:e.path,query:e.query},l=await Q.resolve(o);if(l.redirect)return void t.redirect(l.status||302,l.redirect);const u={...l},c=p.a.createElement(O,{context:o,client:s,insertCss:n,__source:{fileName:pt,lineNumber:120},__self:void 0},l.component);await Object(y.getDataFromTree)(c);const d=i.a.resolve("./build/loadable-stats.json"),m=new I.ChunkExtractor({statsFile:d,entrypoints:["client"]}),f=m.collectChunks(c),g=m.getScriptElements(),_=m.getLinkElements();u.children=await h.a.renderToString(f),u.styles=[{id:"css",cssText:[...r].join("")}];const w=new Set,T=e=>{dt.a[e]&&dt.a[e].forEach(e=>w.add(e))};T("client"),l.chunk&&T(l.chunk),l.chunks&&l.chunks.forEach(T),g&&(u.asyncScripts=Array.from(g)),_&&(u.asyncScripts=Array.from(_)),u.scripts=Array.from(w),u.app={apiUrl:U.a.api.clientUrl,cache:s.extract()};const N=h.a.renderToStaticMarkup(p.a.createElement(k,a()({},u,{__source:{fileName:pt,lineNumber:165},__self:void 0})));t.status(l.status||200),t.send(`<!doctype html>${N}`)}catch(e){r(e)}});const ht=new g.a;ht.skipNodeFiles(),ht.skipPackage("express"),mt.use((e,t,r,n)=>{console.error(ht.render(e));const a=h.a.renderToStaticMarkup(p.a.createElement(k,{title:"Internal Server Error",description:e.message,keywords:"Error",styles:[{id:"css",cssText:G.a._getCss()}],__source:{fileName:pt,lineNumber:184},__self:void 0},h.a.renderToString(p.a.createElement(B,{error:e,__source:{fileName:pt,lineNumber:190},__self:void 0}))));r.status(e.status||500),r.send(`<!doctype html>${a}`)}),we.sync().catch(e=>console.error(e.stack)).then(()=>{mt.listen(U.a.port,()=>{console.info(`The server is running at http://localhost:${U.a.port}/`)})});t.default=mt},function(e,t){e.exports=require("isomorphic-style-loader/useStyles")},function(e,t){e.exports=require("react-modal")},function(e,t){e.exports=require("@loadable/component")},function(e,t){e.exports=require("react-tabs")},function(e,t){e.exports=require("react-icons/fa")},function(e,t){e.exports=require("lodash/throttle")},function(e,t){e.exports=require("exenv")},function(e,t){e.exports=require("history")},function(e,t){e.exports=require("react-day-picker/DayPickerInput")},function(e,t){e.exports=require("react-day-picker")},function(e,t){e.exports=require("date-fns/format")},function(e,t){e.exports=require("date-fns/parse")}]);
//# sourceMappingURL=server.js.map