require("source-map-support").install(),module.exports=function(e){var t={},n={11:0};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.e=function(t){if(0!==n[t]){var r=require("./chunks/"+({0:"admin~contact~drawings~home~not-found~paintings~presentation~privacy~sculptures",1:"drawings~paintings~sculptures",2:"admin",3:"contact",4:"drawings",5:"home",6:"not-found",7:"paintings",8:"presentation",9:"privacy",10:"sculptures"}[t]||t)+".js"),i=r.modules,o=r.ids;for(var a in i)e[a]=i[a];for(var s=0;s<o.length;s++)n[o[s]]=0}return Promise.all([])},r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/assets/",r.oe=function(e){process.nextTick((function(){throw e}))},r(r.s=37)}([function(e,t){e.exports=require("sequelize")},function(e,t,n){e.exports={port:process.env.PORT||3e3,trustProxy:process.env.TRUST_PROXY||"loopback",api:{clientUrl:process.env.API_CLIENT_URL||"",serverUrl:process.env.API_SERVER_URL||`http://localhost:${process.env.PORT||3e3}`},databaseUrl:process.env.DATABASE_URL||"mysql:database.mysql",databaseName:process.env.DATABASE_NAME||"develop",databaseUsername:process.env.DATABASE_USERNAME||"root",databasePassword:process.env.DATABASE_PASSWORD||"root",databaseHost:process.env.DATABASE_HOST||"localhost",libraryPath:`${process.env.PHOTOS_PATH}`,paintingsPath:`${process.env.PHOTOS_PATH}/paintings`,paintingsMDPath:`${process.env.PHOTOS_PATH}/paintings/md`,paintingsSMPath:`${process.env.PHOTOS_PATH}/paintings/sm`,sculpturesPath:`${process.env.PHOTOS_PATH}/sculptures`,sculpturesMDPath:`${process.env.PHOTOS_PATH}/sculptures/md`,sculpturesSMPath:`${process.env.PHOTOS_PATH}/sculptures/sm`,drawingsPath:`${process.env.PHOTOS_PATH}/drawings`,drawingsMDPath:`${process.env.PHOTOS_PATH}/drawings/md`,drawingsSMPath:`${process.env.PHOTOS_PATH}/drawings/sm`,miscellaneousPath:`${process.env.PHOTOS_PATH}/miscellaneous`,analytics:{googleTrackingId:process.env.GOOGLE_TRACKING_ID},auth:{jwt:{name:process.env.JWT_NAME||"auth-token",secret:process.env.JWT_SECRET||"15htDn-7uU-620Ghhwz"}}}},function(e,t,n){"use strict";t.a={PAINTING:{TYPE:"painting",PATH:"/images/paintings",TITLE:"Peintures",ALT_IMAGE:"Peinture de Marion Casters"},DRAWING:{TYPE:"drawing",PATH:"/images/drawings",TITLE:"Dessins",ALT_IMAGE:"Dessin de Marion Casters"},SCULPTURE:{TYPE:"sculpture",PATH:"/images/sculptures",TITLE:"Sculptures",ALT_IMAGE:"Sculpture de Marion Casters"},LG_SIZE:"lg",MD_SIZE:"md",SM_SIZE:"sm",SM_PX:384,MD_PX:640,FORMAT_DATE:"dd/MM/yyyy"}},function(e,t){e.exports=require("lodash")},function(e,t,n){"use strict";t.a={HOME:"/home",PEINTURES:"/peintures",SCULPTURES:"/sculptures",DESSINS:"/dessins",CONTACT:"/contact",PRESENTATION:"/presentation",CONFIDENTIALITE:"/politique-de-confidentialite",REGISTER:"/register",ADMIN:"/admin"}},function(e,t){e.exports=require("react")},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("react-dom/server")},function(e,t,n){"use strict";t.a={TYPE:"content",KEY:{HOME1:"Home 1",HOME2:"Home 2",HOME3:"Home 3",PRESENTATION:"Présentation",CONTACT_ADDRESS:"Adresse",CONTACT_PHONE:"Téléphone",CONTACT_EMAIL:"Email"},CONTENT_IMAGE_PATH:"/images/miscellaneous",PRESENTATION_IMAGE_TITLE:"portrait",PRESENTATION_IMAGE_FILE:"portrait.jpg",PRESENTATION_IMAGE_ALT:"Portrait de Marion Casters",HOME_IMAGE_PORTRAIT:"home-portrait",HOME_IMAGE_LANDSCAPE:"home-landscape",HOME_IMAGE_PORTRAIT_FILE:"home-portrait.jpg",HOME_IMAGE_LANDSCAPE_FILE:"home-landscape.jpg",HOME_IMAGE_ALT:"Oeuvre de Marion Casters"}},function(e,t,n){var r=n(39),i=n(36),o="string"==typeof r?[[e.i,r,""]]:r;(t=e.exports=r.locals||{})._getContent=function(){return o},t._getCss=function(){return""+r},t._insertCss=function(e){return i(o,e)}},function(e,t){e.exports=require("express")},function(e,t){e.exports=require("apollo-cache-inmemory")},function(e,t){e.exports=require("jimp")},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("body-parser")},function(e,t){e.exports=require("apollo-server-express")},function(e,t){e.exports=require("bcrypt")},function(e,t){e.exports=require("./chunk-manifest.json")},function(e,t){e.exports=require("prop-types")},function(e,t){e.exports=require("@apollo/react-hooks")},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}));const r="Marion Casters Artiste Peintre Peinture Sculpture Dessin Bordeaux France",i={PAINTING:"Images et descriptions des peintures de Marion Casters",SCULPTURE:"Images et descriptions des sculptures de Marion Casters",DRAWING:"Images et descriptions des dessins de Marion Casters",HOME:"Bienvenue sur le site de présentation des oeuvres de Marion Casters",PRESENTATION:"Démarche artistique de Marion Casters",CONTACT:"Contacter Marion Casters pour obtenir des renseignements sur ses oeuvres",PRIVACY:"Détail de la politique de confidentialité du site",ADMIN:"Administration du site"}},function(e,t,n){"use strict";var r=n(5);const i=Object(r.createContext)({pathname:"",query:{}});t.a=i},function(e,t){e.exports=require("isomorphic-style-loader/withStyles")},function(e,t){e.exports=require("pretty-error")},function(e,t){e.exports=require("@apollo/react-ssr")},function(e,t){e.exports=require("cors")},function(e,t){e.exports=require("express-session")},function(e,t){e.exports=require("isomorphic-style-loader/StyleContext")},function(e,t){e.exports=require("serialize-javascript")},function(e,t){e.exports=require("universal-router")},function(e,t){e.exports=require("apollo-client")},function(e,t){e.exports=require("apollo-link")},function(e,t){e.exports=require("apollo-link-error")},function(e,t){e.exports=require("apollo-link-schema")},function(e,t){e.exports=require("graphql-tag")},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n=e[1]||"",r=e[3];if(!r)return n;if(t&&"function"==typeof btoa){var i=(a=r,s=btoa(unescape(encodeURIComponent(JSON.stringify(a)))),u="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),"/*# ".concat(u," */")),o=r.sources.map((function(e){return"/*# sourceURL=".concat(r.sourceRoot).concat(e," */")}));return[n].concat(o).concat([i]).join("\n")}var a,s,u;return[n].join("\n")}(t,e);return t[2]?"@media ".concat(t[2],"{").concat(n,"}"):n})).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var r={},i=0;i<this.length;i++){var o=this[i][0];null!=o&&(r[o]=!0)}for(var a=0;a<e.length;a++){var s=e[a];null!=s[0]&&r[s[0]]||(n&&!s[2]?s[2]=n:n&&(s[2]="(".concat(s[2],") and (").concat(n,")")),t.push(s))}},t}},function(e,t,n){"use strict";
/*! Isomorphic Style Loader | MIT License | https://github.com/kriasoft/isomorphic-style-loader */var r={};function i(e){e.forEach((function(e){if(--r[e]<=0){var t=document.getElementById(e);t&&t.parentNode.removeChild(t)}}))}e.exports=function(e,t){for(var n,o=void 0===t?{}:t,a=o.replace,s=void 0!==a&&a,u=o.prepend,l=void 0!==u&&u,c=o.prefix,p=void 0===c?"s":c,d=[],f=0;f<e.length;f++){var h=e[f],y=h[0],m=h[1],g=h[2],v=h[3],w=""+p+y+"-"+f;if(d.push(w),!r[w]||s){r[w]=1;var P=document.getElementById(w),E=!1;P||(E=!0,(P=document.createElement("style")).setAttribute("type","text/css"),P.id=w,g&&P.setAttribute("media",g));var O=m;v&&"function"==typeof btoa&&(O+="\n/*# sourceMappingURL=data:application/json;base64,"+(n=JSON.stringify(v),btoa(encodeURIComponent(n).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode("0x"+t)}))))+"*/",O+="\n/*# sourceURL="+v.file+"?"+w+"*/"),"textContent"in P?P.textContent=O:P.styleSheet.cssText=O,E&&(l?document.head.insertBefore(P,document.head.childNodes[0]):document.head.appendChild(P))}else r[w]++}return i.bind(null,d)}},function(e,t,n){n(38),e.exports=n(40)},function(e,t){e.exports=require("@babel/polyfill")},function(e,t,n){(e.exports=n(35)(!1)).push([e.i,"html{display:flex;align-items:center;justify-content:center;padding:0 2rem;height:100%;font-family:sans-serif;text-align:center;color:#888}body{margin:0}h1{font-weight:400;color:#555}pre{white-space:pre-wrap;text-align:left}",""])},function(e,t,n){"use strict";n.r(t);var r,i=n(13),o=n.n(i),a=n(10),s=n.n(a),u=n(14),l=n.n(u),c=n(5),p=n.n(c),d=n(7),f=n.n(d),h=n(23),y=n.n(h),m=n(24),g=n(15),v=n(25),w=n.n(v),P=n(26),E=n.n(P),O=n(19),S=n(27),T=n.n(S),I=(n(18),n(21));function b(e,t,n,i){r||(r="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=i;else if(a>1){for(var s=new Array(a),u=0;u<a;u++)s[u]=arguments[u+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:r,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var D,A=({client:e,insertCss:t,context:n,children:r})=>b(O.ApolloProvider,{client:e},void 0,b(I.a.Provider,{value:n},void 0,b(T.a.Provider,{value:{insertCss:t}},void 0,r))),x=n(28),N=n.n(x),j=n(1),_=n.n(j);function q(e,t,n,r){D||(D="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=r;else if(o>1){for(var a=new Array(o),s=0;s<o;s++)a[s]=arguments[s+3];t.children=a}if(t&&i)for(var u in i)void 0===t[u]&&(t[u]=i[u]);else t||(t=i||{});return{$$typeof:D,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var M=q("meta",{charSet:"utf-8"}),C=q("meta",{httpEquiv:"x-ua-compatible",content:"ie=edge"}),R=q("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),U=q("meta",{name:"theme-color",content:"#555555"}),k=q("link",{rel:"manifest",href:"/site.webmanifest"}),$=q("link",{rel:"apple-touch-icon",sizes:"192x192",href:"/icon-192.png"}),V=q("link",{rel:"icon",sizes:"192x192",href:"/icon-192.png"}),L=q("link",{rel:"icon",sizes:"512x512",href:"/icon-512.png"}),H=q("link",{href:"https://fonts.googleapis.com/css?family=Montserrat&display=swap",rel:"stylesheet"}),G=q("script",{src:"https://www.google-analytics.com/analytics.js",async:!0,defer:!0});var B,Y=({title:e,description:t,keywords:n,styles:r=[],scripts:i=[],asyncScripts:o=[],asyncLinks:a=[],app:s,children:u})=>q("html",{className:"no-js",lang:"fr"},void 0,q("head",{},void 0,M,C,q("title",{},void 0,e),q("meta",{name:"description",content:t}),q("meta",{name:"keywords",content:n}),R,U,i.map(e=>q("link",{rel:"preload",href:e,as:"script"},e)),a.map(e=>e),k,$,V,L,H,r.map(e=>q("style",{id:e.id,dangerouslySetInnerHTML:{__html:e.cssText}},e.id))),q("body",{},void 0,q("div",{id:"app",dangerouslySetInnerHTML:{__html:u}}),q("script",{dangerouslySetInnerHTML:{__html:`window.App=${N()(s)}`}}),i.map(e=>q("script",{src:e},e)),o.map(e=>e),_.a.analytics.googleTrackingId&&q("script",{dangerouslySetInnerHTML:{__html:"window.ga=function(){ga.q.push(arguments)};ga.q=[];ga.l=+new Date;"+`ga('create','${_.a.analytics.googleTrackingId}','auto');ga('send','pageview')`}}),_.a.analytics.googleTrackingId&&G)),F=n(22),z=n.n(F),W=n(9),K=n.n(W);function Q(e,t,n,r){B||(B="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=r;else if(o>1){for(var a=new Array(o),s=0;s<o;s++)a[s]=arguments[s+3];t.children=a}if(t&&i)for(var u in i)void 0===t[u]&&(t[u]=i[u]);else t||(t=i||{});return{$$typeof:B,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var X=Q("div",{},void 0,Q("h1",{},void 0,"Error"),Q("p",{},void 0,"Sorry, a critical error occurred on this page."));function J({error:e}){return X}J.defaultProps={error:null};z()(K.a)(J);var Z=n(29),ee=n.n(Z),te=n(20),ne=n(4);function re(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}var ie={path:"",children:[{path:"",load:()=>Promise.all([n.e(0),n.e(5)]).then(n.bind(null,155))},{path:ne.a.HOME,load:()=>Promise.all([n.e(0),n.e(5)]).then(n.bind(null,155))},{path:ne.a.PEINTURES,load:()=>Promise.all([n.e(0),n.e(1),n.e(7)]).then(n.bind(null,152))},{path:ne.a.SCULPTURES,load:()=>Promise.all([n.e(0),n.e(1),n.e(10)]).then(n.bind(null,157))},{path:ne.a.DESSINS,load:()=>Promise.all([n.e(0),n.e(1),n.e(4)]).then(n.bind(null,156))},{path:ne.a.PRESENTATION,load:()=>Promise.all([n.e(0),n.e(8)]).then(n.bind(null,159))},{path:ne.a.CONTACT,load:()=>Promise.all([n.e(0),n.e(3)]).then(n.bind(null,154))},{path:ne.a.CONFIDENTIALITE,load:()=>Promise.all([n.e(0),n.e(9)]).then(n.bind(null,153))},{path:ne.a.ADMIN,load:()=>Promise.all([n.e(0),n.e(2)]).then(n.bind(null,151))},{path:"(.*)",load:()=>Promise.all([n.e(0),n.e(6)]).then(n.bind(null,158))}],action({next:e}){return(t=function*(){const t=yield e();return t.title=`${t.title||"Page sans titre"} - Marion Casters`,t.description=t.description||"-",t.keywords=te.b,t},function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(e){re(o,r,i,a,s,"next",e)}function s(e){re(o,r,i,a,s,"throw",e)}a(void 0)}))})();var t}},oe=new ee.a(ie,{resolveRoute:(e,t)=>"function"==typeof e.route.load?e.route.load().then(n=>n.default(e,t)):"function"==typeof e.route.action?e.route.action(e,t):void 0}),ae=n(30),se=n(31),ue=n(32),le=n(33),ce=n(34),pe=n.n(ce),de=n(11);function fe(e){switch(e.__typename){case"NewsItem":return e.link?`NewsItem:${e.link}`:Object(de.defaultDataIdFromObject)(e);default:return Object(de.defaultDataIdFromObject)(e)}}var he=n(3);const ye=["\n  adminStatus: AdminStatus!\n"],me=[...["\n  type AdminStatus {\n    isConnected: Boolean!\n  }\n"]],ge=n.n(he)()({}),ve=[...ye],we=[];function Pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pe(n,!0).forEach((function(t){Oe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pe(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Oe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Se(e){const t=new de.InMemoryCache({dataIdFromObject:fe});t.writeData({data:{adminStatus:{__typename:"AdminStatus",isConnected:!1}}});const n=Object(se.from)([Object(ue.onError)(({graphQLErrors:e,networkError:t})=>{e&&e.map(({message:e,locations:t,path:n})=>console.warn(`[GraphQL error]: Message: ${e}, Location: ${t}, Path: ${n}`)),t&&console.warn(`[Network error]: ${t}`)}),new le.SchemaLink(Ee({},e))]);return new ae.ApolloClient({link:n,cache:t,typeDefs:pe()(me),resolvers:ge,ssrMode:!0,queryDeduplication:!0})}var Te=n(0),Ie=n.n(Te);var be=new Ie.a(_.a.databaseName,_.a.databaseUsername,_.a.databasePassword,{host:_.a.databaseHost,dialect:"mysql",operatorsAliases:Te.Op,define:{freezeTableName:!0,timestamps:!1}});var De=be.define("User",{id:{type:Ie.a.UUID,defaultValue:Ie.a.UUIDV1,primaryKey:!0},username:{type:Ie.a.STRING(50),unique:!0},email:{type:Ie.a.STRING(50),validate:{isEmail:!0},unique:!0},emailConfirmed:{type:Ie.a.BOOLEAN,defaultValue:!1},password:Ie.a.STRING(255)},{indexes:[{fields:["username"]}]});var Ae=be.define("Painting",{id:{type:Ie.a.UUID,defaultValue:Ie.a.UUIDV1,primaryKey:!0,get(){return this.getDataValue("id")}},title:{type:Ie.a.STRING(50),allowNull:!1,get(){return this.getDataValue("title")},set(e){this.setDataValue("title",e)}},date:{type:Ie.a.DATEONLY,allowNull:!1,get(){return this.getDataValue("date")},set(e){this.setDataValue("date",e)}},technique:{type:Ie.a.STRING(255),allowNull:!1,get(){return this.getDataValue("technique")},set(e){this.setDataValue("technique",e)}},description:{type:Ie.a.STRING(255),allowNull:!0,get(){return this.getDataValue("description")},set(e){this.setDataValue("description",e)}},height:{type:Ie.a.INTEGER,allowNull:!1,get(){return this.getDataValue("height")},set(e){this.setDataValue("height",e)}},width:{type:Ie.a.INTEGER,allowNull:!1,get(){return this.getDataValue("width")},set(e){this.setDataValue("width",e)}}},{timestamps:!0});var xe=be.define("Sculpture",{id:{type:Ie.a.UUID,defaultValue:Ie.a.UUIDV1,primaryKey:!0,get(){return this.getDataValue("id")}},title:{type:Ie.a.STRING(50),allowNull:!1,get(){return this.getDataValue("title")},set(e){this.setDataValue("title",e)}},date:{type:Ie.a.DATEONLY(10),allowNull:!1,get(){return this.getDataValue("date")},set(e){this.setDataValue("date",e)}},technique:{type:Ie.a.STRING(255),allowNull:!1,get(){return this.getDataValue("technique")},set(e){this.setDataValue("technique",e)}},description:{type:Ie.a.STRING(255),allowNull:!0,get(){return this.getDataValue("description")},set(e){this.setDataValue("description",e)}},height:{type:Ie.a.INTEGER,allowNull:!1,get(){return this.getDataValue("height")},set(e){this.setDataValue("height",e)}},width:{type:Ie.a.INTEGER,allowNull:!1,get(){return this.getDataValue("width")},set(e){this.setDataValue("width",e)}},length:{type:Ie.a.INTEGER,allowNull:!1,get(){return this.getDataValue("length")},set(e){this.setDataValue("length",e)}}},{timestamps:!0});var Ne=be.define("Drawing",{id:{type:Ie.a.UUID,defaultValue:Ie.a.UUIDV1,primaryKey:!0,get(){return this.getDataValue("id")}},title:{type:Ie.a.STRING(50),allowNull:!1,get(){return this.getDataValue("title")},set(e){this.setDataValue("title",e)}},date:{type:Ie.a.DATEONLY(10),allowNull:!1,get(){return this.getDataValue("date")},set(e){this.setDataValue("date",e)}},technique:{type:Ie.a.STRING(255),allowNull:!1,get(){return this.getDataValue("technique")},set(e){this.setDataValue("technique",e)}},description:{type:Ie.a.STRING(255),allowNull:!0,get(){return this.getDataValue("description")},set(e){this.setDataValue("description",e)}},height:{type:Ie.a.INTEGER,allowNull:!1,get(){return this.getDataValue("height")},set(e){this.setDataValue("height",e)}},width:{type:Ie.a.INTEGER,allowNull:!1,get(){return this.getDataValue("width")},set(e){this.setDataValue("width",e)}}},{timestamps:!0});var je=be.define("Content",{id:{type:Ie.a.UUID,defaultValue:Ie.a.UUIDV1,primaryKey:!0,get(){return this.getDataValue("id")}},key:{type:Ie.a.STRING(50),allowNull:!1,get(){return this.getDataValue("key")},set(e){this.setDataValue("key",e)}},text:{type:Ie.a.TEXT,allowNull:!1,get(){return this.getDataValue("text")},set(e){this.setDataValue("text",e)}}});var _e={sync:function(...e){return be.sync(...e)}},qe=n(2);function Me(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ce(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function Re(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){Ce(o,r,i,a,s,"next",e)}function s(e){Ce(o,r,i,a,s,"throw",e)}a(void 0)}))}}function Ue(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ke=class{constructor(e){var t=this;Ue(this,"getByName",function(){var e=Re((function*(e){return t.model.findOne({where:{title:e}})}));return function(t){return e.apply(this,arguments)}}()),Ue(this,"getById",function(){var e=Re((function*(e){return t.model.findOne({where:{id:e}})}));return function(t){return e.apply(this,arguments)}}()),Ue(this,"getAllItems",Re((function*(){return t.model.findAll({order:Te.Sequelize.col("date")})}))),Ue(this,"getItemsByPart",function(){var e=Re((function*(e,n){let r,i;return 0===n?(r=new Date(e,0,1),i=new Date(e,11,31)):1===n?(r=new Date(e,0,1),i=new Date(e,5,31)):(r=new Date(e,6,1),i=new Date(e,11,31)),t.model.findAll({where:{date:{[Te.Op.gte]:r,[Te.Op.lte]:i}},order:Te.Sequelize.col("date")})}));return function(t,n){return e.apply(this,arguments)}}()),Ue(this,"add",function(){var e=Re((function*(e){return t.model.create(e)}));return function(t){return e.apply(this,arguments)}}()),Ue(this,"update",function(){var e=Re((function*(e,n){return yield t.model.update(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Me(n,!0).forEach((function(t){Ue(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Me(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({id:e},n),{where:{id:e}}),yield t.model.findOne({where:{id:e}})}));return function(t,n){return e.apply(this,arguments)}}()),Ue(this,"delete",function(){var e=Re((function*(e){return t.model.destroy({where:{id:e}})}));return function(t){return e.apply(this,arguments)}}()),this.model={},this.init(e)}init(e){if(e===qe.a.PAINTING.TYPE)this.model=Ae;else if(e===qe.a.DRAWING.TYPE)this.model=Ne;else{if(e!==qe.a.SCULPTURE.TYPE)throw new Error(`Type ${e} inexistant`);this.model=xe,this.isSculpture=!0}}get(e){if(!this.has(e))throw new Error(`Property ${e} not found`);return this.model[e]}has(e){return e in this.model}};function $e(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function Ve(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){$e(o,r,i,a,s,"next",e)}function s(e){$e(o,r,i,a,s,"throw",e)}a(void 0)}))}}const Le=["\n  type Item {\n    id: ID!\n    title: String!\n    date: String!\n    technique: String!\n    description: String\n    length: Int\n    height: Int!\n    width: Int!\n  }\n"],He=["\n  getAllItems(\n     type: String!\n  ): [Item]\n  \n  getItemsByPart(\n    year: Int!\n    type: String!\n    half: Int!\n  ): [Item]\n"],Ge={RootQuery:{getAllItems:(e,{type:t})=>Ve((function*(){return new ke(t).getAllItems()}))(),getItemsByPart:(e,{type:t,year:n,half:r})=>Ve((function*(){return new ke(t).getItemsByPart(n,r)}))()}};var Be=n(6),Ye=n.n(Be),Fe=n(12),ze=n.n(Fe),We=n(8);function Ke(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function Qe(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){Ke(o,r,i,a,s,"next",e)}function s(e){Ke(o,r,i,a,s,"throw",e)}a(void 0)}))}}const Xe=(e,t)=>{const n=`${e}.jpg`;return t===qe.a.SCULPTURE.TYPE?[`${_.a.sculpturesPath}/${n}`,`${_.a.sculpturesMDPath}/${n}`,`${_.a.sculpturesSMPath}/${n}`]:t===qe.a.DRAWING.TYPE?[`${_.a.drawingsPath}/${n}`,`${_.a.drawingsMDPath}/${n}`,`${_.a.drawingsSMPath}/${n}`]:t===qe.a.PAINTING.TYPE?[`${_.a.paintingsPath}/${n}`,`${_.a.paintingsMDPath}/${n}`,`${_.a.paintingsSMPath}/${n}`]:null},Je=function(){var e=Qe((function*(e,t){const{stream:n}=yield e;return new Promise((e,r)=>n.pipe(Ye.a.createWriteStream(t)).on("error",e=>{n.truncated&&Ye.a.unlinkSync(t),r(e)}).on("finish",()=>{e(!0)}))}));return function(t,n){return e.apply(this,arguments)}}(),Ze=(e,t,n)=>new Promise((r,i)=>ze.a.read(e,(e,o)=>{e&&i(e);const a=o.getHeight()<o.getWidth(),s=a?n:ze.a.AUTO,u=a?ze.a.AUTO:n;o.resize(s,u).quality(80).write(t),r(!0)})),et=function(){var e=Qe((function*(e,t,n){const r=Xe(n,t);return Promise.all([yield Je(e,r[0]),Ze(r[0],r[1],qe.a.MD_PX),Ze(r[0],r[2],qe.a.SM_PX)])}));return function(t,n,r){return e.apply(this,arguments)}}(),tt=function(){var e=Qe((function*(e,t){return Promise.all(e.map((e,n)=>{const r=`${t}_${n+1}`;return et(e,qe.a.SCULPTURE.TYPE,r)}))}));return function(t,n){return e.apply(this,arguments)}}(),nt=function(){var e=Qe((function*(e,t,n){const r=Xe(e,n),i=Xe(t,n);return Promise.all(r.map((e,t)=>(Ye.a.existsSync(e)&&Ye.a.rename(e,i[t],e=>!e),!1)))}));return function(t,n,r){return e.apply(this,arguments)}}(),rt=function(){var e=Qe((function*(e){Ye.a.unlink(`${e}`,e=>!e)}));return function(t){return e.apply(this,arguments)}}(),it=function(){var e=Qe((function*(e,t,n){if(n===qe.a.SCULPTURE.TYPE)return tt(e,t);const r=yield e[0];if(n===We.a.TYPE){const e=`${_.a.miscellaneousPath}/${t}.jpg`;return Je(r,e)}return et(r,n,t)}));return function(t,n,r){return e.apply(this,arguments)}}(),ot=function(){var e=Qe((function*(e,t,n){if(n===qe.a.SCULPTURE.TYPE){let r=1;const i=[];for(;r<5;){const o=`${e}_${r}`,a=`${t}_${r}`;i.push(nt(o,a,n)),r++}return Promise.all(i)}return nt(e,t,n)}));return function(t,n,r){return e.apply(this,arguments)}}(),at=function(){var e=Qe((function*(e,t){let n;if(t===qe.a.SCULPTURE.TYPE){let r;for(n=[],r=1;r<5;r++)Array.prototype.push.apply(n,Xe(`${e}_${r}`,t))}else n=Xe(e,t);return yield n.every(rt)}));return function(t,n){return e.apply(this,arguments)}}();function st(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}var ut=function(){var e,t=(e=function*(e){return!!e.session.userId&&!!(yield De.findOne({where:{id:e.session.userId}}))},function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){st(o,r,i,a,s,"next",e)}function s(e){st(o,r,i,a,s,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}();function lt(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function ct(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function pt(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){ct(o,r,i,a,s,"next",e)}function s(e){ct(o,r,i,a,s,"throw",e)}a(void 0)}))}}const dt={Mutation:{addItem(e,t,{req:n}){let{input:{pictures:r,type:i}}=t,o=lt(t.input,["pictures","type"]);return pt((function*(){if(!(yield ut(n)))throw new Error("Erreur d'authentification");const{title:e}=o,t=new ke(i);if(yield t.getByName(e))throw new Error("Nom de l'item déjà existant en Bdd");if(!(yield it(r,e,i)))throw new Error("Erreur à l'écriture des fichiers");const a=yield t.add(o,i);if(!a)throw at(e,i),new Error("Erreur à l'enregistrement en base de donnée");return a}))()},updateItem(e,t,{req:n}){let{id:r,input:{pictures:i,type:o}}=t,a=lt(t.input,["pictures","type"]);return pt((function*(){if(!(yield ut(n)))throw new Error("Erreur d'authentification");const e=new ke(o),t=yield e.getById(r);if(!t)throw new Error("Item à modifier introuvable en BDD");const{title:s}=a,u=yield e.getByName(s,o);if(u&&u.id!==r)throw new Error("Nom d'item déjà existant en Bdd");const l=t.title;if(i.length>0){if(!(yield at(l,o)))throw new Error("Echec de la suppression des anciennes images");if(!(yield it(i,s,o)))throw new Error("Erreur à l'écriture des nouveaux fichiers")}else if(l!==s){if(!(yield ot(l,s,o)))throw new Error("Erreur au renommage des fichiers")}const c=yield e.update(r,a);if(!c)throw new Error("Erreur à l'enregistrement en base de donnée");return c}))()},deleteItem:(e,{id:t,type:n},{req:r})=>pt((function*(){if(!(yield ut(r)))throw new Error("Erreur d'authentification");const e=new ke(n),i=yield e.getById(t);if(!i)throw new Error("Item absent en BDD");if(!(yield at(i.title,n)))throw new Error("Echec de la suppression des images");return e.delete(t).then(e=>e).catch(()=>{throw new Error("Echec de la suppression en Bdd")}),t}))()}},ft=[...Le,...["\n  input ItemInput {\n    pictures: [Upload]!\n    type: String!\n    title: String!\n    date: String!\n    technique: String!\n    description: String\n    length: Int\n    height: Int!\n    width: Int!\n  }\n  "]],ht=[...He],yt=[...["\n  addItem (\n    input: ItemInput!\n  ): Item!\n  \n  updateItem (\n    id: ID!\n    input: ItemInput!\n  ): Item!\n  \n  deleteItem(\n     id: ID!\n     type: String!\n  ): ID!\n"]],mt=Object(he.merge)(Ge,dt);function gt(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function vt(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){gt(o,r,i,a,s,"next",e)}function s(e){gt(o,r,i,a,s,"throw",e)}a(void 0)}))}}const wt=["\n  type DatabaseUser {\n    id: String\n    username: String\n    email: String\n    password: String\n  }\n"],Pt=["\n  getAllUsers: [DatabaseUser]\n\n  getUser(\n    username: String!\n  ): DatabaseUser\n  \n  checkIsAdmin: Boolean!\n"],Et={RootQuery:{getAllUsers:()=>vt((function*(){return De.findAll()}))(),getUser:(e,{username:t})=>vt((function*(){return De.findOne({where:{username:t}})}))(),checkIsAdmin:(e,t,{req:n})=>vt((function*(){return n.session.isAdmin}))()}};var Ot=n(16),St=n.n(Ot);function Tt(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function It(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){Tt(o,r,i,a,s,"next",e)}function s(e){Tt(o,r,i,a,s,"throw",e)}a(void 0)}))}}const bt=["\n  input SignupInput {\n    username: String!\n    email: String!\n    password: String!\n  }\n  \n  input LoginInput {\n    username: String!\n    password: String!\n  }\n"],Dt=["\n  signup(\n    input: SignupInput!\n  ): Boolean\n  \n  login(\n    input: LoginInput!\n  ): Boolean\n  \n  logout: Boolean\n"],At={Mutation:{signup:(jt=It((function*(e,{input:t},{req:n}){if(yield De.findOne({where:{username:t.username}}))throw new Error("Utilisateur déjà existant");const r=yield St.a.hash(t.password,10);if(!r)throw new Error("Erreur de hashing du mot de passe");const i=yield De.create({username:t.username,email:t.email,password:r});if(!i)throw new Error("Erreur à la création du user en BDD");return n.session.userId=i.id,!0})),function(e,t,n){return jt.apply(this,arguments)}),login:(Nt=It((function*(e,{input:{username:t,password:n}},{req:r}){const i=yield De.findOne({where:{username:t}});return!!i&&!!(yield St.a.compare(n,i.password))&&(r.session.userId=i.id,!0)})),function(e,t,n){return Nt.apply(this,arguments)}),logout:(xt=It((function*(e,t,{req:n,res:r}){return n.session.destroy(()=>!1),r.clearCookie(_.a.auth.jwt.name),!0})),function(e,t,n){return xt.apply(this,arguments)})}};var xt,Nt,jt;const _t=[...wt,...bt],qt=[...Pt],Mt=[...Dt],Ct=Object(he.merge)(Et,At);function Rt(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function Ut(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){Rt(o,r,i,a,s,"next",e)}function s(e){Rt(o,r,i,a,s,"throw",e)}a(void 0)}))}}const kt=["\n  type Content {\n    id: ID!\n    key: String!\n    text: String!\n  }\n"],$t=["\n  getAllContent: [Content]\n  \n  getContent(key: String!): Content\n"],Vt={RootQuery:{getAllContent:()=>Ut((function*(){return yield je.findAll()}))(),getContent:(e,{key:t})=>Ut((function*(){return yield je.findOne({where:{key:t}})}))()}};function Lt(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function Ht(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){Lt(o,r,i,a,s,"next",e)}function s(e){Lt(o,r,i,a,s,"throw",e)}a(void 0)}))}}const Gt=["\n  input ContentInput {\n    key: String!\n    text: String!\n  }\n  "],Bt=["\n  addContent(input: ContentInput!): Content!\n  \n  addPicture(picture: Upload!, title: String!): Boolean!\n"],Yt={Mutation:{addContent:function(){var e=Ht((function*(e,{input:t},{req:n}){yield ut(n);const{key:r}=t;let i=yield je.findOne({where:{key:r}});return i?(yield i.update({text:t.text}),i=yield je.findOne({where:{key:r}})):i=yield je.create(t),i}));return function(t,n,r){return e.apply(this,arguments)}}(),addPicture:(e,{picture:t,title:n},{req:r})=>Ht((function*(){if(!(yield ut(r)))throw new Error("Erreur d'authentification");const e=[t];if(!(yield it(e,n,We.a.TYPE)))throw new Error("Erreur à l'écriture des fichiers");return!0}))()}},Ft=[...kt,...Gt],zt=[...$t],Wt=[...Bt],Kt=Object(he.merge)(Vt,Yt);function Qt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Xt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Jt,Zt=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qt(n,!0).forEach((function(t){Xt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qt(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({typeDefs:[...[" \n  schema { \n    query: RootQuery \n    mutation: Mutation \n  } \n"],...[` \n  type RootQuery { \n    ${[...ht,...qt,...zt,...ve]} \n  } \n`],...[` \n  type Mutation { \n    ${[...yt,...Mt,...Wt,...we]} \n  } \n`],...[...Ft,...ft,..._t,...me]],resolvers:Object(he.merge)(mt,Ct,Kt)},{}),en=n(17),tn=n.n(en);function nn(e,t,n,r){Jt||(Jt="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=r;else if(o>1){for(var a=new Array(o),s=0;s<o;s++)a[s]=arguments[s+3];t.children=a}if(t&&i)for(var u in i)void 0===t[u]&&(t[u]=i[u]);else t||(t=i||{});return{$$typeof:Jt,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function rn(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function on(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function an(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?on(n,!0).forEach((function(t){sn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):on(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function sn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}process.on("unhandledRejection",(e,t)=>{console.error("Unhandled Rejection at:",t,"reason:",e),process.exit(1)}),global.navigator=global.navigator||{},global.navigator.userAgent=global.navigator.userAgent||"all";const un=s()();un.set("trust proxy",_.a.trustProxy),un.use(s.a.static(o.a.resolve(__dirname,"public"))),un.use("/images",s.a.static(o.a.resolve(_.a.libraryPath))),un.use(l.a.urlencoded({extended:!0})),un.use(l.a.json()),un.use(w()()),un.use(E()({name:_.a.auth.jwt.name,secret:_.a.auth.jwt.secret,resave:!0,saveUninitialized:!0,cookie:{httpOnly:!0,secure:!0,maxAge:864e5}})),new g.ApolloServer(an({cors:!0},Zt,{context:({req:e,res:t})=>({req:e,res:t}),uploads:!0,introspection:!1,playground:!1,debug:!1,pretty:!1})).applyMiddleware({app:un}),un.get("*",function(){var e,t=(e=function*(e,t,n){try{const n=new Set,r=(...e)=>{e.forEach(e=>n.add(e._getCss()))},i=Se({schema:Object(g.makeExecutableSchema)(Zt),context:{req:e}}),o={pathname:e.path,query:e.query},a=yield oe.resolve(o);if(a.redirect)return void t.redirect(a.status||302,a.redirect);const s=an({},a),u=nn(A,{context:o,client:i,insertCss:r},void 0,a.component);yield Object(m.getDataFromTree)(u),s.children=yield f.a.renderToString(u),s.styles=[{id:"css",cssText:[...n].join("")}];const l=new Set,c=e=>{tn.a[e]&&tn.a[e].forEach(e=>l.add(e))};c("client"),a.chunk&&c(a.chunk),a.chunks&&a.chunks.forEach(c),s.scripts=Array.from(l),s.app={apiUrl:_.a.api.clientUrl,cache:i.extract()};const d=f.a.renderToStaticMarkup(p.a.createElement(Y,s));t.status(a.status||200),t.send(`<!doctype html>${d}`)}catch(e){n(e)}},function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){rn(o,r,i,a,s,"next",e)}function s(e){rn(o,r,i,a,s,"throw",e)}a(void 0)}))});return function(e,n,r){return t.apply(this,arguments)}}());const ln=new y.a;ln.skipNodeFiles(),ln.skipPackage("express"),un.use((e,t,n,r)=>{console.error(ln.render(e));const i=f.a.renderToStaticMarkup(nn(Y,{title:"Internal Server Error",description:e.message,keywords:"Error",styles:[{id:"css",cssText:K.a._getCss()}]},void 0,f.a.renderToString(nn(J,{error:e}))));n.status(e.status||500),n.send(`<!doctype html>${i}`)}),_e.sync().catch(e=>console.error(e.stack)).then(()=>{un.listen(_.a.port,()=>{console.info(`The server is running at http://localhost:${_.a.port}/`)})});t.default=un},function(e,t){e.exports=require("isomorphic-style-loader/useStyles")},function(e,t){e.exports=require("react-modal")},function(e,t){e.exports=require("react-tabs")},function(e,t){e.exports=require("react-icons/fa")},function(e,t){e.exports=require("lodash/throttle")},function(e,t){e.exports=require("exenv")},function(e,t){e.exports=require("history")},function(e,t){e.exports=require("react-day-picker/DayPickerInput")},function(e,t){e.exports=require("react-day-picker")},function(e,t){e.exports=require("date-fns/format")},function(e,t){e.exports=require("date-fns/parse")}]);
//# sourceMappingURL=server.js.map